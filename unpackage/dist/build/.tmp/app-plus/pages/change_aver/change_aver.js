(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/change_aver/change_aver"],{"4b5a":function(t,e,c){"use strict";var a=c("a92f"),i=c.n(a);i.a},"651b":function(t,e,c){"use strict";c.r(e);var a=c("c9de"),i=c.n(a);for(var o in a)"default"!==o&&function(t){c.d(e,t,function(){return a[t]})}(o);e["default"]=i.a},"69d4":function(t,e,c){"use strict";var a=function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("view",{staticClass:"container"},[c("view",{staticClass:"page-body uni-content-info"},[c("view",{staticClass:"cropper-content"},[t.isShowImg?c("view",{staticClass:"uni-corpper",style:"width:"+t.cropperInitW+"px;height:"+t.cropperInitH+"px;background:#000"},[c("view",{staticClass:"uni-corpper-content",style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px;left:"+t.cropperL+"px;top:"+t.cropperT+"px"},[c("image",{style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px",attrs:{src:t.imageSrc}}),c("view",{staticClass:"uni-corpper-crop-box",style:"left:"+t.cutL+"px;top:"+t.cutT+"px;right:"+t.cutR+"px;bottom:"+t.cutB+"px",attrs:{eventid:"034b1b4c-1"},on:{touchstart:function(e){e.stopPropagation(),t.contentStartMove(e)},touchmove:function(e){e.stopPropagation(),t.contentMoveing(e)},touchend:function(e){e.stopPropagation(),t.contentTouchEnd(e)}}},[c("view",{staticClass:"uni-cropper-view-box"},[c("view",{staticClass:"uni-cropper-point point-rb",attrs:{"data-drag":"rightBottom",eventid:"034b1b4c-0"},on:{touchstart:function(e){e.stopPropagation(),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),t.dragMove(e)}}})])])])]):t._e()]),c("view",{staticClass:"cropper-config"},[c("button",{attrs:{type:"primary reverse",eventid:"034b1b4c-2"},on:{click:t.getImage}},[t._v("选择图片")]),c("button",{staticStyle:{"margin-left":"30rpx"},attrs:{type:"warn",eventid:"034b1b4c-3"},on:{click:t.getImageInfo}},[t._v("点击生成图片")])],1),c("view",{staticClass:"submit"},[c("button",{attrs:{eventid:"034b1b4c-4"},on:{click:function(e){t.submit()}}},[t._v("生成头像")])],1),c("canvas",{style:"position:absolute;border: 1px solid red; width:"+t.imageW+"px;height:"+t.imageH+"px;top:-9999px;left:-9999px;",attrs:{"canvas-id":"myCanvas"}})])])},i=[];c.d(e,"a",function(){return a}),c.d(e,"b",function(){return i})},"8cf3":function(t,e,c){"use strict";c("bdf4");var a=o(c("b0ce")),i=o(c("dbf3"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(i.default))},a92f:function(t,e,c){},c9de:function(t,e,c){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c,a,i,o,r,n,s,u,p,h,g,d=t.getSystemInfoSync(),l=d.screenWidth,f=(d.pixelRatio,1),v=100,m=d.screenWidth,b={data:function(){return{name:"杨大宝",imageSrc:"https://img-cdn-qiniu.dcloud.net.cn/demo_crop.jpg",isShowImg:!1,cropperInitW:l,cropperInitH:l,cropperW:l,cropperH:l,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:l,cutR:"100%",qualityWidth:m,innerAspectRadio:f}},onLoad:function(t){},mounted:function(){this.loadImage()},methods:{setData:function(t){var e=this;Object.keys(t).forEach(function(c){e.$set(e.$data,c,t[c])})},getImage:function(){var e=this;t.chooseImage({success:function(t){e.setData({imageSrc:t.tempFilePaths[0]}),e.loadImage()}})},loadImage:function(){var e=this;t.showLoading({title:"图片加载中..."}),t.getImageInfo({src:e.imageSrc,success:function(c){p=c.width/c.height,p>=1?(h=l,g=l/p):(h=l*p,g=l);var a=h>g?h:g;if(v=a>v?v:a,p>=1){var i=Math.ceil((l/p-(l/p-v))/4),o=i,r=Math.ceil(l-l+v),n=r;e.setData({cropperW:l,cropperH:l/p,cropperL:Math.ceil((l-l)/2),cropperT:Math.ceil((l-l/p)/2),cutL:r,cutT:i,cutR:n,cutB:o,imageW:h,imageH:g,scaleP:h/l,qualityWidth:m,innerAspectRadio:p})}else{var s=Math.ceil(l*p-l*p),u=s,d=Math.ceil((l-v)/4),f=d;e.setData({cropperW:l*p,cropperH:l,cropperL:Math.ceil((l-l*p)/2),cropperT:Math.ceil((l-l)/2),cutL:s,cutT:d,cutR:u,cutB:f,imageW:h,imageH:g,scaleP:h/l,qualityWidth:m,innerAspectRadio:p})}e.setData({isShowImg:!0}),t.hideLoading()}})},contentStartMove:function(t){c=t.touches[0].pageX,a=t.touches[0].pageY},contentMoveing:function(t){var e=(c-t.touches[0].pageX)*f,i=(a-t.touches[0].pageY)*f;e>0?this.cutL-e<0&&(e=this.cutL):this.cutR+e<0&&(e=-this.cutR),i>0?this.cutT-i<0&&(i=this.cutT):this.cutB+i<0&&(i=-this.cutB),this.setData({cutL:this.cutL-e,cutT:this.cutT-i,cutR:this.cutR+e,cutB:this.cutB+i}),c=t.touches[0].pageX,a=t.touches[0].pageY},contentTouchEnd:function(){},getImageInfo:function(){var e=this;t.showLoading({title:"图片生成中..."});var c=t.createCanvasContext("myCanvas");c.drawImage(e.imageSrc,0,0,h,g),c.draw(!0,function(){var c=(e.cropperW-e.cutL-e.cutR)/e.cropperW*h,a=(e.cropperH-e.cutT-e.cutB)/e.cropperH*g,i=e.cutL/e.cropperW*h,o=e.cutT/e.cropperH*g;t.canvasToTempFilePath({x:i,y:o,width:c,height:a,destWidth:c,destHeight:a,quality:.5,canvasId:"myCanvas",success:function(e){t.hideLoading(),t.previewImage({current:"",urls:[e.tempFilePath]})}})})},dragStart:function(t){i=t.touches[0].pageX,o=t.touches[0].pageY,r=this.cutL,s=this.cutR,u=this.cutB,n=this.cutT},dragMove:function(t){var e=t.target.dataset.drag;switch(e){case"right":var c=(i-t.touches[0].pageX)*f;s+c<0&&(c=-s),this.setData({cutR:s+c});break;case"left":c=(i-t.touches[0].pageX)*f;r-c<0&&(c=r),r-c>this.cropperW-this.cutR&&(c=r-(this.cropperW-this.cutR)),this.setData({cutL:r-c});break;case"top":c=(o-t.touches[0].pageY)*f;n-c<0&&(c=n),n-c>this.cropperH-this.cutB&&(c=n-(this.cropperH-this.cutB)),this.setData({cutT:n-c});break;case"bottom":c=(o-t.touches[0].pageY)*f;u+c<0&&(c=-u),this.setData({cutB:u+c});break;case"rightBottom":var a=(i-t.touches[0].pageX)*f,p=(o-t.touches[0].pageY)*f;u+p<0&&(p=-u),s+a<0&&(a=-s);var h=u+p,g=s+a;this.setData({cutB:h,cutR:g});break;default:break}},submit:function(){console.log("submit")}}};e.default=b}).call(this,c("649d")["default"])},dbf3:function(t,e,c){"use strict";c.r(e);var a=c("69d4"),i=c("651b");for(var o in i)"default"!==o&&function(t){c.d(e,t,function(){return i[t]})}(o);c("4b5a");var r=c("2877"),n=Object(r["a"])(i["default"],a["a"],a["b"],!1,null,null,null);e["default"]=n.exports}},[["8cf3","common/runtime","common/vendor"]]]);